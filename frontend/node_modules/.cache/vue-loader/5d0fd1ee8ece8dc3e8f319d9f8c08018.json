{"remainingRequest":"/Users/berlin/Documents/platform/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/berlin/Documents/platform/frontend/src/components/EventBulletin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/berlin/Documents/platform/frontend/src/components/EventBulletin.vue","mtime":1634085832805},{"path":"/Users/berlin/Documents/platform/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1634257404436},{"path":"/Users/berlin/Documents/platform/frontend/node_modules/babel-loader/lib/index.js","mtime":1634257405404},{"path":"/Users/berlin/Documents/platform/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1634257404436},{"path":"/Users/berlin/Documents/platform/frontend/node_modules/vue-loader/lib/index.js","mtime":1634257407250}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBnZW5lcmFsTWl4aW4gZnJvbSAnLi4vbWl4aW5zL2dlbmVyYWwnOwppbXBvcnQgc2NoZWR1bGVNaXhpbiBmcm9tICcuLi9taXhpbnMvc2NoZWR1bGUnOwppbXBvcnQgWm9vbUJ1dHRvbiBmcm9tICcuL1pvb21CdXR0b24udnVlJzsKaW1wb3J0IEJ1dHRvbiBmcm9tICcuL0J1dHRvbi52dWUnOwppbXBvcnQgTG9hZGluZ1NwaW5uZXIgZnJvbSAnLi9Mb2FkaW5nU3Bpbm5lci52dWUnOwppbXBvcnQgTGl2ZUljb24gZnJvbSAnLi9MaXZlSWNvbic7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0V2ZW50QnVsbGV0aW4nLAogIG1peGluczogW2dlbmVyYWxNaXhpbiwgc2NoZWR1bGVNaXhpbl0sCiAgcHJvcHM6IHsKICAgIGV2ZW50Q291bnQ6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiA4LAogICAgfSwKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmdTcGlubmVyLAogICAgWm9vbUJ1dHRvbiwKICAgIEJ1dHRvbiwKICAgIExpdmVJY29uLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJhd0V2ZW50czogW10sCiAgICAgIGRheXM6IFtdLAogICAgICBzZWxlY3RlZEV2ZW50OiBudWxsLAogICAgICBkYXRhTG9hZGVkOiBmYWxzZSwKICAgICAgc3RhcnREYXRlOiBuZXcgRGF0ZSh0aGlzLmdldEVudlZhcmlhYmxlKCdTVEFSVF9EQVRFJykpLAogICAgICBlbmREYXRlOiBuZXcgRGF0ZSh0aGlzLmdldEVudlZhcmlhYmxlKCdFTkRfREFURScpKSwKICAgICAgdGFyZ2V0RXZlbnRJZDogbnVsbCwKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBvcGVuU2NoZWRNb2RhbChldmVudCkgewogICAgICBjb25zb2xlLmxvZyh7IGV2ZW50IH0pOwogICAgICB0aGlzLiRlbWl0KCdvcGVuU2NoZWR1bGVNb2RhbCcsIGV2ZW50KTsKICAgIH0sCiAgICBhc3luYyB0cmFja0V2ZW50QXR0ZW5kYW5jZShzZWxlY3RlZEV2ZW50KSB7CiAgICAgIGNvbnNvbGUubG9nKCdldmVudCcsIHNlbGVjdGVkRXZlbnQuY2F0ZWdvcnkpOwogICAgICAvLyBXaHkgbXVzdCB5b3UgZG8gdGhpcyB0byBtZSBFc2xpbnQKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZQogICAgICBjb25zdCB7IGNhdGVnb3J5LCBldmVudF9uYW1lIH0gPSBzZWxlY3RlZEV2ZW50OwogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlCiAgICAgIGNvbnN0IGFjaGlldmVtZW50TmFtZSA9IGBBdHRlbmRlZCAke2V2ZW50X25hbWV9YDsKICAgICAgYXdhaXQgdGhpcy5hZGRBY2hpZXZlbWVudCh0aGlzLmdldFVzZXJJZCgpLCBhY2hpZXZlbWVudE5hbWUsIGBldmVudC0ke2NhdGVnb3J5fWApOwogICAgfSwKICAgIGV2ZW50SXNMaXZlKGV2ZW50KSB7CiAgICAgIC8vIFJldHVybnMgaWYgdGhlIGV2ZW50IHVzIGN1cnJlbnRseSBoYXBwZW5pbmcKICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShldmVudC5zdGFydF90aW1lKTsKICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUoZXZlbnQuZW5kX3RpbWUpOwogICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwoKICAgICAgcmV0dXJuIChzdGFydCA8PSBub3cpICYmIChub3cgPD0gZW5kKTsKICAgIH0sCiAgfSwKICBhc3luYyBtb3VudGVkKCkgewogICAgdGhpcy5yYXdFdmVudHMgPSBhd2FpdCB0aGlzLmdldERhdGEoCiAgICAgIHRoaXMuZ2V0RW52VmFyaWFibGUoJ0JBQ0tFTkQnKSwKICAgICAgJ3NjaGVkdWxlJywKICAgICk7CiAgICB0aGlzLmRhdGFMb2FkZWQgPSB0cnVlOwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHVwY29taW5nRXZlbnRzKCkgewogICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwoKICAgICAgY29uc3QgZXZlbnRzV2l0aERhdGVzID0gdGhpcy5yYXdFdmVudHMubWFwKChldmVudCkgPT4gKHsKICAgICAgICAuLi5ldmVudCwKICAgICAgICBzdGFydF90aW1lOiBuZXcgRGF0ZShldmVudC5zdGFydF90aW1lKSwKICAgICAgICBlbmRfdGltZTogbmV3IERhdGUoZXZlbnQuZW5kX3RpbWUpLAogICAgICB9KSk7CgogICAgICByZXR1cm4gZXZlbnRzV2l0aERhdGVzCiAgICAgICAgLmZpbHRlcigoYSkgPT4gYS5lbmRfdGltZSA+PSBub3cpCiAgICAgICAgLnNvcnQoKGEsIGIpID0+IHsKICAgICAgICAgIGNvbnN0IGJ0aW1lID0gYi5zdGFydF90aW1lOwogICAgICAgICAgY29uc3QgYXRpbWUgPSBhLnN0YXJ0X3RpbWU7CiAgICAgICAgICByZXR1cm4gYXRpbWUuZ2V0VGltZSgpIC0gYnRpbWUuZ2V0VGltZSgpOwogICAgICAgIH0pCiAgICAgICAgLnNsaWNlKDAsIHRoaXMuZXZlbnRDb3VudCk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["EventBulletin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EventBulletin.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div\n    v-if=\"dataLoaded\"\n    class=\"card-container\"\n  >\n    <template v-if=\"upcomingEvents.length > 0\">\n      <div\n        class=\"d-flex event-card\"\n        v-for=\"event in upcomingEvents\"\n        :key=\"event.id\"\n      >\n        <div class=\"banner-img-container\">\n          <img\n            class=\"banner-img\"\n            :src=\"getBannerImgForEvent(event)\"\n          />\n        </div>\n        <div class=\"card-content ml-3 text-left d-flex flex-column\">\n          <div class=\"top-header-row\">\n            <h3 class=\"event-title\">{{ event.event_name }}\n            </h3>\n            <LiveIcon\n              :isLive=\"eventIsLive(event)\"\n              class=\"live-icon\"\n            />\n          </div>\n          <p class=\"text-muted\"><em>{{getTimeDescriptionForEvent(event)}}</em></p>\n          <p class=\"max-lines-2\">{{event.description}}</p>\n          <div class=\"btn-container d-flex\">\n            <Button\n              outlined\n              size=\"sm\"\n              @click=\"openSchedModal(event)\"\n            >\n              Learn More\n            </Button>\n            <ZoomButton\n              v-if=\"eventIsLive(event)\"\n              :href=\"getLinkForEvent(event)\"\n              @click=\"trackEventAttendance(event)\"\n              class=\"ml-auto\"\n            >\n              Attend\n            </ZoomButton>\n          </div>\n        </div>\n      </div>\n    </template>\n    <div v-else>\n      <!--\n        TODO: waiting on design for updated error image, will replace when we can\n        <img\n        class=\"error-img mt-5\"\n        src=\"../assets/error-icon.png\"\n      />-->\n      <p class=\"no-events-text\">No upcoming events!</p>\n    </div>\n  </div>\n  <LoadingSpinner v-else />\n</template>\n\n<script>\nimport generalMixin from '../mixins/general';\nimport scheduleMixin from '../mixins/schedule';\nimport ZoomButton from './ZoomButton.vue';\nimport Button from './Button.vue';\nimport LoadingSpinner from './LoadingSpinner.vue';\nimport LiveIcon from './LiveIcon';\n\nexport default {\n  name: 'EventBulletin',\n  mixins: [generalMixin, scheduleMixin],\n  props: {\n    eventCount: {\n      type: Number,\n      default: 8,\n    },\n  },\n  components: {\n    LoadingSpinner,\n    ZoomButton,\n    Button,\n    LiveIcon,\n  },\n  data() {\n    return {\n      rawEvents: [],\n      days: [],\n      selectedEvent: null,\n      dataLoaded: false,\n      startDate: new Date(this.getEnvVariable('START_DATE')),\n      endDate: new Date(this.getEnvVariable('END_DATE')),\n      targetEventId: null,\n    };\n  },\n  methods: {\n    openSchedModal(event) {\n      console.log({ event });\n      this.$emit('openScheduleModal', event);\n    },\n    async trackEventAttendance(selectedEvent) {\n      console.log('event', selectedEvent.category);\n      // Why must you do this to me Eslint\n      // eslint-disable-next-line camelcase\n      const { category, event_name } = selectedEvent;\n      // eslint-disable-next-line camelcase\n      const achievementName = `Attended ${event_name}`;\n      await this.addAchievement(this.getUserId(), achievementName, `event-${category}`);\n    },\n    eventIsLive(event) {\n      // Returns if the event us currently happening\n      const start = new Date(event.start_time);\n      const end = new Date(event.end_time);\n      const now = new Date();\n\n      return (start <= now) && (now <= end);\n    },\n  },\n  async mounted() {\n    this.rawEvents = await this.getData(\n      this.getEnvVariable('BACKEND'),\n      'schedule',\n    );\n    this.dataLoaded = true;\n  },\n  computed: {\n    upcomingEvents() {\n      const now = new Date();\n\n      const eventsWithDates = this.rawEvents.map((event) => ({\n        ...event,\n        start_time: new Date(event.start_time),\n        end_time: new Date(event.end_time),\n      }));\n\n      return eventsWithDates\n        .filter((a) => a.end_time >= now)\n        .sort((a, b) => {\n          const btime = b.start_time;\n          const atime = a.start_time;\n          return atime.getTime() - btime.getTime();\n        })\n        .slice(0, this.eventCount);\n    },\n  },\n};\n</script>\n\n<style scoped>\n.top-header-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n}\n\n.live-icon {\n  margin-left: 0.5rem;\n  flex-shrink: 0;\n}\n\n.event-title {\n  font-family: var(--body-font);\n  margin-bottom: -0.25rem;\n  font-size: 1.75rem;\n}\n\n.banner-img-container {\n  width: 33%;\n  min-width: 150px;\n  border-radius: var(--border-radius);\n  overflow: hidden;\n  flex-shrink: 0;\n}\n\n.banner-img {\n  height: 100%;\n  width: 100%;\n  object-fit: cover;\n}\n\n.event-card {\n  border-top: 3px solid var(--color-light-border);\n  padding: 2rem 1rem;\n}\n\n.event-card:first-of-type {\n  border-top: 0;\n}\n\n.btn {\n  margin: 0;\n}\n\n.btn-container {\n  margin-top: auto;\n}\n\n.card-content {\n  /* Flexbox witchcraft due to the default min-width being auto */\n  min-width: 0px;\n  flex: 1;\n}\n\n.event-title {\n  margin-bottom: 0;\n  font-family: var(--body-font);\n}\n\n.error-img {\n  width: 200px;\n}\n\n.no-events-text {\n  font-size: 1.75rem;\n  margin-top: 3rem;\n  font-weight: bold;\n}\n</style>\n"]}]}